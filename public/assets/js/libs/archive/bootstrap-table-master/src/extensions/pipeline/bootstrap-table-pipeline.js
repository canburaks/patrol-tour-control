const Utils=$.fn.bootstrapTable.utils;$.extend($.fn.bootstrapTable.defaults,{usePipeline:!1,pipelineSize:1e3,onCachedDataHit:t=>!1,onCachedDataReset:t=>!1}),$.extend($.fn.bootstrapTable.Constructor.EVENTS,{"cached-data-hit.bs.table":"onCachedDataHit","cached-data-reset.bs.table":"onCachedDataReset"});const BootstrapTable=$.fn.bootstrapTable.Constructor,_init=BootstrapTable.prototype.init,_onSearch=BootstrapTable.prototype.onSearch,_onSort=BootstrapTable.prototype.onSort,_onPageListChange=BootstrapTable.prototype.onPageListChange;BootstrapTable.prototype.init=function(...t){this.initPipeline(),_init.apply(this,Array.prototype.slice.apply(t))},BootstrapTable.prototype.initPipeline=function(){this.cacheRequestJSON={},this.cacheWindows=[],this.currWindow=0,this.resetCache=!0},BootstrapTable.prototype.onSearch=function(){this.options.usePipeline&&(this.resetCache=!0),_onSearch.apply(this,Array.prototype.slice.apply(arguments))},BootstrapTable.prototype.onSort=function(){this.options.usePipeline&&(this.resetCache=!0),_onSort.apply(this,Array.prototype.slice.apply(arguments))},BootstrapTable.prototype.onPageListChange=function(t){const e=$(t.currentTarget),i=parseInt(e.text());this.options.pipelineSize=this.calculatePipelineSize(this.options.pipelineSize,i),this.resetCache=!0,_onPageListChange.apply(this,Array.prototype.slice.apply(arguments))},BootstrapTable.prototype.calculatePipelineSize=(t,e)=>0===e?0:Math.ceil(t/e)*e,BootstrapTable.prototype.setCacheWindows=function(){this.cacheWindows=[];const t=this.options.totalRows/this.options.pipelineSize;for(let e=0;e<=t;e++){const t=e*this.options.pipelineSize;this.cacheWindows[e]={lower:t,upper:t+this.options.pipelineSize-1}}},BootstrapTable.prototype.setCurrWindow=function(t){this.currWindow=0;for(let e=0;e<this.cacheWindows.length;e++)if(this.cacheWindows[e].lower<=t&&t<=this.cacheWindows[e].upper){this.currWindow=e;break}},BootstrapTable.prototype.drawFromCache=function(t,e){const i=$.extend(!0,{},this.cacheRequestJSON),o=t-this.cacheWindows[this.currWindow].lower,s=o+e;return i.rows=i.rows.slice(o,s),i},BootstrapTable.prototype.initServer=function(t,e,i){let o={};const s=this.header.fields.indexOf(this.options.sortName);let a={searchText:this.searchText,sortName:this.options.sortName,sortOrder:this.options.sortOrder},n=null;if(this.header.sortNames[s]&&(a.sortName=this.header.sortNames[s]),this.options.pagination&&"server"===this.options.sidePagination&&(a.pageSize=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,a.pageNumber=this.options.pageNumber),!i&&!this.options.url&&!this.options.ajax)return;let r=!0;if("limit"===this.options.queryParamsType&&(a={searchText:a.searchText,sortName:a.sortName,sortOrder:a.sortOrder},this.options.pagination&&"server"===this.options.sidePagination))if(a.limit=this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize,a.offset=(this.options.pageSize===this.options.formatAllRows()?this.options.totalRows:this.options.pageSize)*(this.options.pageNumber-1),this.options.usePipeline)if(this.cacheWindows.length){const t=this.cacheWindows[this.currWindow];this.resetCache||a.offset<t.lower||a.offset>t.upper?(r=!0,this.setCurrWindow(a.offset),a.drawOffset=a.offset,a.offset=this.cacheWindows[this.currWindow].lower):r=!1}else r=!0,a.drawOffset=a.offset;else 0===a.limit&&delete a.limit;if(this.resetCache&&(r=!0,this.resetCache=!1),this.options.usePipeline&&r&&(a.drawLimit=a.limit,a.limit=this.options.pipelineSize),!r){const t=this.drawFromCache(a.offset,a.limit);return this.load(t),this.trigger("load-success",t),void this.trigger("cached-data-hit",t)}if($.isEmptyObject(this.filterColumnsPartial)||(a.filter=JSON.stringify(this.filterColumnsPartial,null)),o=Utils.calculateObjectValue(this.options,this.options.queryParams,[a],o),$.extend(o,e||{}),!1===o)return;t||this.$tableLoading.show();const p=this;n=$.extend({},Utils.calculateObjectValue(null,this.options.ajaxOptions),{type:this.options.method,url:i||this.options.url,data:"application/json"===this.options.contentType&&"post"===this.options.method?JSON.stringify(o):o,cache:this.options.cache,contentType:this.options.contentType,dataType:this.options.dataType,success(e){e=Utils.calculateObjectValue(p.options,p.options.responseHandler,[e],e),p.options.usePipeline&&(p.cacheRequestJSON=$.extend(!0,{},e),p.options.totalRows=e[p.options.totalField],p.setCacheWindows(),p.setCurrWindow(a.drawOffset),e=p.drawFromCache(a.drawOffset,a.drawLimit),p.trigger("cached-data-reset",e)),p.load(e),p.trigger("load-success",e),t||p.$tableLoading.hide()},error(e){let i=[];"server"===p.options.sidePagination&&(i={},i[p.options.totalField]=0,i[p.options.dataField]=[]),p.load(i),p.trigger("load-error",e.status,e),t||p.$tableLoading.hide()}}),this.options.ajax?Utils.calculateObjectValue(this,this.options.ajax,[n],null):(this._xhr&&4!==this._xhr.readyState&&this._xhr.abort(),this._xhr=$.ajax(n))};